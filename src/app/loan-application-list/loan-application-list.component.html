<div class="page-header">
  <div class="header-left">
    <h2 class="title">ðŸŒ¿ ESG Loan Applications</h2>
    <p class="subtitle">Monitor and assess all customer loan requests with real-time ESG compliance status.</p>
  </div>

  <div class="header-actions">
    <button pButton label="Refresh" icon="pi pi-refresh" class="p-button-success shadow-btn"
            (click)="loadLoans()"></button>
  </div>
</div>

<p-panel [toggleable]="true" class="esg-panel">

  <p-table
    [value]="loanApplications"
    [paginator]="true"
    [rows]="10"
    [rowsPerPageOptions]="[5,10,20]"
    [responsiveLayout]="'scroll'"
    [rowHover]="true"
    dataKey="loanApplicationId"
    class="esg-table"
  >

    <ng-template pTemplate="header">
      <tr>
        <th pSortableColumn="applicationDate">Date <p-sortIcon field="applicationDate"></p-sortIcon></th>
        <th pSortableColumn="customerName">Customer <p-sortIcon field="customerName"></p-sortIcon></th>
        <th pSortableColumn="productName">Product <p-sortIcon field="productName"></p-sortIcon></th>
        <th pSortableColumn="amount">Amount <p-sortIcon field="amount"></p-sortIcon></th>
        <th pSortableColumn="interestRate">Interest (%) <p-sortIcon field="interestRate"></p-sortIcon></th>
        <th pSortableColumn="tenorInDays">Tenor (Days) <p-sortIcon field="tenorInDays"></p-sortIcon></th>
        <th pSortableColumn="sectorName">Sector <p-sortIcon field="sectorName"></p-sortIcon></th>
        <th>Status</th>
        <th>ESG Risk Rating</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row>
      <tr class="table-row" (click)="openAssessment(row)">
        <td>{{ row.applicationDate | date:'dd-MMM-yyyy' }}</td>
        <td>{{ row.customerName }}</td>
        <td>{{ row.productName }}</td>
        <td>{{ row.amount | number:'1.0-0' }}</td>
        <td>{{ row.interestRate }}</td>
        <td>{{ row.tenorInDays }}</td>
        <td>{{ row.sectorName }}</td>

        <td>
          <span class="status-badge" [ngClass]="getStatusClass(row.approvalStatusId)">
            {{ row.statusName }}
          </span>
        </td>
        <td>
        <span class="risk-badge" [ngClass]="getRiskClass(row.riskRatingId)">
          {{ row.riskRating }}
        </span>
      </td>
      </tr>
    </ng-template>

  </p-table>

</p-panel>
